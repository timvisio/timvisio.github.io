<!DOCTYPE html>
            <html lang='ru'>
            <head>
                <meta charset='UTF-8'>
                <meta name='viewport' content='width=device-width, initial-scale=1.0'>
                <title>Справка — PanelTimVisioPro</title>
                <style>
                    * { margin: 0; padding: 0; box-sizing: border-box; }
                    body {
                        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                        line-height: 1.6;
                        color: #333;
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        padding: 20px;
                        min-height: 100vh;
                    }
                    .container {
                        max-width: 1000px;
                        margin: 0 auto;
                        background: white;
                        border-radius: 15px;
                        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                        overflow: hidden;
                    }
                    header {
                        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                        color: white;
                        padding: 30px;
                        text-align: center;
                    }
                    h1 {
                        font-size: 2.5em;
                        margin-bottom: 10px;
                        text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
                    }
                    .subtitle {
                        font-size: 1.1em;
                        opacity: 0.9;
                        margin-bottom: 5px;
                    }
                    .version {
                        background: rgba(255,255,255,0.2);
                        display: inline-block;
                        padding: 5px 15px;
                        border-radius: 20px;
                        font-size: 0.9em;
                        margin-top: 10px;
                    }
                    nav {
                        background: #f8f9fa;
                        padding: 15px;
                        border-bottom: 2px solid #e9ecef;
                    }
                    nav ul {
                        list-style: none;
                        display: flex;
                        justify-content: center;
                        gap: 20px;
                        flex-wrap: wrap;
                    }
                    nav a {
                        text-decoration: none;
                        color: #667eea;
                        font-weight: 600;
                        padding: 8px 15px;
                        border-radius: 8px;
                        transition: all 0.3s;
                    }
                    nav a:hover {
                        background: #667eea;
                        color: white;
                    }
                    .content {
                        padding: 30px;
                    }
                    section {
                        margin-bottom: 40px;
                        padding-bottom: 30px;
                        border-bottom: 1px solid #e9ecef;
                    }
                    section:last-child {
                        border-bottom: none;
                        margin-bottom: 0;
                        padding-bottom: 0;
                    }
                    h2 {
                        color: #667eea;
                        font-size: 1.8em;
                        margin-bottom: 20px;
                        padding-bottom: 10px;
                        border-bottom: 3px solid #f0f0f0;
                    }
                    h3 {
                        color: #764ba2;
                        font-size: 1.4em;
                        margin: 25px 0 15px 0;
                    }
                    p {
                        margin-bottom: 15px;
                        font-size: 1.05em;
                    }
                    .highlight {
                        background: #fff3cd;
                        border-left: 4px solid #ffc107;
                        padding: 15px;
                        margin: 20px 0;
                        border-radius: 5px;
                    }
                    .tip {
                        background: #d1ecf1;
                        border-left: 4px solid #17a2b8;
                        padding: 15px;
                        margin: 20px 0;
                        border-radius: 5px;
                    }
                    .warning {
                        background: #f8d7da;
                        border-left: 4px solid #dc3545;
                        padding: 15px;
                        margin: 20px 0;
                        border-radius: 5px;
                    }
                    table {
                        width: 100%;
                        border-collapse: collapse;
                        margin: 20px 0;
                        font-size: 0.95em;
                    }
                    th, td {
                        padding: 12px;
                        text-align: left;
                        border-bottom: 1px solid #dee2e6;
                    }
                    th {
                        background: #667eea;
                        color: white;
                        font-weight: 600;
                    }
                    tr:hover {
                        background: #f8f9fa;
                    }
                    .btn-type {
                        display: inline-block;
                        padding: 3px 10px;
                        border-radius: 15px;
                        font-size: 0.85em;
                        font-weight: 600;
                        color: white;
                    }
                    .type-1 { background: #28a745; }
                    .type-2 { background: #ffc107; color: #333; }
                    .type-3 { background: #dc3545; }
                    .type-4 { background: #17a2b8; }
                    .type-5 { background: #e83e8c; }
                    .type-6 { background: #6c757d; }
                    .type-7 { background: #20c997; }
                    .type-8 { background: #6f42c1; }
                    .type-9 { background: #fd7e14; }
                    .type-10 { background: #d63384; }
                    .type-11 { background: #198754; }
                    .type-12 { background: #0dcaf0; }
                    .emoji {
                        font-size: 1.3em;
                        margin-right: 5px;
                    }
                    .step {
                        counter-increment: step-counter;
                        margin: 15px 0;
                        padding-left: 30px;
                        position: relative;
                    }
                    .step::before {
                        content: counter(step-counter);
                        position: absolute;
                        left: 0;
                        top: 0;
                        width: 24px;
                        height: 24px;
                        background: #667eea;
                        color: white;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-weight: bold;
                        font-size: 0.9em;
                    }
                    .context-menu {
                        background: #f8f9fa;
                        border-left: 4px solid #667eea;
                        padding: 15px;
                        margin: 20px 0;
                        border-radius: 5px;
                    }
                    .context-menu ul {
                        list-style: none;
                        padding-left: 20px;
                    }
                    .context-menu li {
                        margin: 8px 0;
                        font-weight: 500;
                    }
                    .context-menu li::before {
                        content: '• ';
                        color: #667eea;
                        font-weight: bold;
                        margin-left: -15px;
                    }
                    code {
                        background: #f8f9fa;
                        padding: 2px 6px;
                        border-radius: 3px;
                        font-family: 'Courier New', monospace;
                        color: #e83e8c;
                    }
                    .example {
                        background: #f8f9fa;
                        border-left: 4px solid #667eea;
                        padding: 15px;
                        margin: 15px 0;
                        border-radius: 5px;
                        font-family: 'Courier New', monospace;
                    }
                    footer {
                        text-align: center;
                        padding: 20px;
                        background: #f8f9fa;
                        color: #6c757d;
                        font-size: 0.9em;
                    }
                    @media (max-width: 768px) {
                        .content { padding: 20px; }
                        h1 { font-size: 2em; }
                        nav ul { flex-direction: column; gap: 10px; }
                    }
                </style>
            </head>
            <body>
                <div class='container'>
                    <header>
                        <h1>📚 Руководство пользователя</h1>
                        <div class='subtitle'>Панель управления для Microsoft Visio</div>
                        <div class='version'>PanelTimVisioPro</div>
                    </header>
        
                    <nav>
                        <ul>
                            <li><a href='#quick-start'>🚀 Быстрый старт</a></li>
                            <li><a href='#button-types'>🔘 Типы кнопок</a></li>
                            <li><a href='#management'>🛠 Управление</a></li>
                            <li><a href='#profiles'>👤 Профили</a></li>
                            <li><a href='#tips'>💡 Советы</a></li>
                        </ul>
                    </nav>
        
                    <div class='content'>
                        <!-- БЫСТРЫЙ СТАРТ -->
                        <section id='quick-start'>
                            <h2>🚀 Быстрый старт</h2>
                
                            <div class='step'>Запустите приложение — откроется панель с кнопками</div>
                            <div class='step'>Наведите курсор на кнопку — справа появятся настройки</div>
                            <div class='step'>Кликните по кнопке — действие выполнится в Visio</div>
                            <div class='step'>Правый клик по кнопке — открывает меню управления</div>
                
                            <div class='highlight'>
                                <strong>⚠️ Важно:</strong> Для работы кнопок типов 1–9 необходимо, чтобы <strong>Microsoft Visio был запущен</strong>. Кнопки типов 10, 12 работают независимо.
                            </div>
                        </section>
            
                        <!-- ТИПЫ КНОПОК -->
                        <section id='button-types'>
                            <h2>🔘 Типы кнопок и их функции</h2>
                            <p>В приложении доступно <strong>12 типов кнопок</strong>. Каждый тип решает свою задачу:</p>
                
                            <table>
                                <thead>
                                    <tr>
                                        <th>Тип</th>
                                        <th>Название</th>
                                        <th>Как настроить</th>
                                        <th>Пример</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><span class='btn-type type-1'>1</span></td>
                                        <td><strong>Вставка фигур</strong></td>
                                        <td>1. Нажмите «Обзор» → выберите <code>.vss</code>/<code>.vssx</code>/<code>.vssm</code> файлы<br>2. В текстовом поле укажите имя фигуры (опционально)</td>
                                        <td><code>Круг</code> — вставит фигуру «Круг» из первого трафарета</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-2'>2</span></td>
                                        <td><strong>Команды Visio</strong></td>
                                        <td>Выберите команду из выпадающего списка</td>
                                        <td>«Выровнять по центру», «Распределить по горизонтали»</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-3'>3</span></td>
                                        <td><strong>Цвет заливки</strong></td>
                                        <td>Введите <code>RGB(255,0,0)</code></td>
                                        <td><code>RGB(0,255,0)</code> — зелёная заливка</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-4'>4</span></td>
                                        <td><strong>Цвет/шаблон линии</strong></td>
                                        <td><code>RGB(0,0,255)</code> — цвет линии<br><code>2</code> — штриховая линия<br><code>USE(&quot;Земля&quot;)</code> — шаблон линии</td>
                                        <td><code>RGB(255,0,0)</code> — красная линия</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-5'>5</span></td>
                                        <td><strong>Команда из контекстного меню</strong></td>
                                        <td>Введите точное имя команды как в меню фигуры</td>
                                        <td><code>Фигура Visio кабельный журнал</code>, <code>Динамический режим</code></td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-6'>6</span></td>
                                        <td><strong>Свойства фигуры (быстро)</strong></td>
                                        <td>Формат: <code>Имя=Значение</code></td>
                                        <td><code>Наименование=Автомат</code><br><code>Высота=100mm</code><br><code>Материал=1</code> (индекс списка)</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-7'>7</span></td>
                                        <td><strong>Нумерация фигур</strong></td>
                                        <td>Не требует настройки</td>
                                        <td>Запускает надстройку «Нумерация фигур»</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-8'>8</span></td>
                                        <td><strong>Экспорт в PDF</strong></td>
                                        <td>Не требует настройки</td>
                                        <td>Сохраняет активный документ как PDF рядом с исходником</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-9'>9</span></td>
                                        <td><strong>Запуск макроса VBA</strong></td>
                                        <td>1. Добавьте трафарет с макросом через «Обзор»<br>2. В текстовом поле укажите имя макроса</td>
                                        <td><code>МойМакрос</code> — выполнит макрос из трафарета</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-10'>10</span></td>
                                        <td><strong>Запуск .exe файлов</strong></td>
                                        <td>Нажмите «Обзор» → выберите <code>.exe</code> файл</td>
                                        <td>Запуск калькулятора, браузера и т.д.</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-11'>11</span></td>
                                        <td><strong>Свойства фигуры (интерактивно)</strong></td>
                                        <td>Укажите имя свойства например <code>Базовая высота</code></td>
                                        <td>При нажатии кнопки появится окно для ввода значения</td>
                                    </tr>
                                    <tr>
                                        <td><span class='btn-type type-12'>12</span></td>
                                        <td><strong>Мультикнопка</strong></td>
                                        <td>Введите номера кнопок через запятую: <code>4.1,4.2,5.1</code></td>
                                        <td>Последовательно выполнит команды кнопок 4.1 → 4.2 → 5.1</td>
                                    </tr>
                                </tbody>
                            </table>
                
                            <div class='tip'>
                                <strong>💡 Как узнать номер кнопки?</strong><br>
                                При наведении курсора на кнопку в подсказке отображается её полный идентификатор:<br>
                                <code>Кнопка 4.2 — Заливка красная</code> → значит, для мультикнопки нужно ввести <code>4.2</code>
                            </div>
                        </section>
            
                        <!-- УПРАВЛЕНИЕ КНОПКАМИ -->
                        <section id='management'>
                            <h2>🛠 Управление кнопками</h2>
                
                            <h3>➕ Добавление кнопки</h3>
                            <ol>
                                <li>Внизу панели найдите элементы управления:<br>
                                    <code>🔢</code> — поле для выбора типа кнопки (1–12)<br>
                                    <code>➕</code> — кнопка «Добавить»</li>
                                <li>Выберите тип → нажмите «Добавить»</li>
                                <li>Новая кнопка появится в панели. Автоматически активируется для настройки</li>
                            </ol>
                
                            <h3>✏️ Переименование кнопки</h3>
                            <div class='context-menu'>
                                <strong>Правый клик по кнопке → «✏️ Переименовать кнопку»</strong>
                                <ul>
                                    <li>Введите новое имя (можно оставить пустым для кнопки без текста)</li>
                                    <li>Нажмите «OK»</li>
                                </ul>
                            </div>
                            <div class='tip'>💡 Совет: Для кнопок с иконками часто удаляют текст — остаётся только иконка.</div>
                
                            <h3>🖼️ Установка иконки</h3>
                            <div class='context-menu'>
                                <strong>Правый клик по кнопке → «🖼️ Установить иконку…»</strong>
                                <ul>
                                    <li>Выберите изображение (поддерживаются <code>.png</code>, <code>.jpg</code>, <code>.jpeg</code>, <code>.gif</code>)</li>
                                    <li>Иконка автоматически масштабируется под размер кнопки</li>
                                </ul>
                            </div>
                
                            <h3>🗑️ Удаление иконки</h3>
                            <div class='context-menu'>
                                <strong>Правый клик → «🗑️ Удалить иконку»</strong>
                                <ul>
                                    <li>Иконка исчезнет, останется только текст</li>
                                </ul>
                            </div>
                
                            <h3>🗑️ Удаление кнопки</h3>
                            <div class='context-menu'>
                                <strong>Правый клик → «🗑️ Удалить кнопку»</strong>
                                <ul>
                                    <li>Подтвердите действие</li>
                                </ul>
                            </div>
                            <div class='warning'>⚠️ Восстановить удалённую кнопку нельзя!</div>
                
                            <h3>⌨️ Горячие клавиши</h3>
                            <h4>Назначение хоткея</h4>
                            <div class='context-menu'>
                                <strong>Правый клик по кнопке → «⌨️ Установить хоткей…»</strong>
                                <ul>
                                    <li>В открывшемся окне <strong>нажмите нужную комбинацию</strong> (например, <code>Ctrl+1</code>, <code>Alt+F2</code>)</li>
                                    <li>Нажмите «OK»</li>
                                </ul>
                            </div>
                            <div class='tip'>
                                ✅ Поддерживаются комбинации с <code>Ctrl</code>, <code>Alt</code>, <code>Shift</code> + любая клавиша (цифры, буквы, <code>F1–F12</code>, <code>Enter</code> и др.).<br>
                                ❌ <strong>Не поддерживаются:</strong> <code>Win</code>, системные сочетания (<code>Alt+Tab</code>, <code>Ctrl+Esc</code>).
                            </div>
                
                            <h4>Как работают хоткеи</h4>
                            <ul>
                                <li>Работают <strong>глобально</strong> — даже когда окно приложения свёрнуто или неактивно</li>
                                <li>При нажатии хоткея выполняется действие кнопки <strong>мгновенно</strong></li>
                                <li>Хоткей отображается в подсказке при наведении: <code>⌨️ Ctrl+1</code></li>
                            </ul>
                
                            <h4>Удаление хоткея</h4>
                            <div class='context-menu'>
                                <strong>Правый клик → «⌫ Удалить хоткей»</strong>
                            </div>
                        </section>
            
                        <!-- РЕЖИМЫ РАБОТЫ -->
                        <section id='modes'>
                            <h2>👁 Режимы работы</h2>
                
                            <h3>Обычный режим (по умолчанию)</h3>
                            <ul>
                                <li>Отображается панель управления справа (список трафаретов, текстовые поля)</li>
                                <li>При <strong>наведении</strong> на кнопку — загружаются её настройки</li>
                                <li>При <strong>клике</strong> — выполняется действие</li>
                            </ul>
                
                            <h3>Минимальный режим</h3>
                            <ol>
                                <li>Включите галочку «☑ Минимальный режим» внизу панели</li>
                                <li>Панель управления скроется — останутся только кнопки</li>
                                <li><strong>Клик по кнопке</strong> — сразу выполняет действие (без предварительного наведения)</li>
                            </ol>
                            <div class='tip'>💡 Идеально для быстрой работы: переключайтесь в минимальный режим после настройки кнопок.</div>
                        </section>
            
                        <!-- ПРОФИЛИ -->
                        <section id='profiles'>
                            <h2>👤 Профили</h2>
                            <p>Профили позволяют хранить разные наборы кнопок для разных задач (например, «Электрика», «Схемы», «Архитектура»).</p>
                
                            <h3>Управление профилями</h3>
                            <ol>
                                <li>Нажмите кнопку «📁 Профили» в правом верхнем углу</li>
                                <li>Откроется окно управления:
                                    <ul>
                                        <li><strong>➕ Новый</strong> — создать профиль</li>
                                        <li><strong>✏️ Переименовать</strong> — изменить имя (кроме «Default»)</li>
                                        <li><strong>🗑️ Удалить</strong> — удалить профиль (кроме «Default»)</li>
                                        <li><strong>✅ Переключиться</strong> — активировать выбранный профиль</li>
                                    </ul>
                                </li>
                            </ol>
                
                            <div class='warning'>⚠️ При удалении профиля все его кнопки и настройки <strong>безвозвратно удаляются</strong>.</div>
                
                            <h3>Как переключаться между профилями</h3>
                            <ul>
                                <li>Название активного профиля отображается в заголовке окна:<br>
                                    <code>PanelTimVisioPro — [Электрика]</code></li>
                                <li>Чтобы переключиться — откройте меню профилей и выберите нужный</li>
                            </ul>
                        </section>
            
                        <!-- СОВЕТЫ И ЛАЙФХАКИ -->
                        <section id='tips'>
                            <h2>💡 Советы и лайфхаки</h2>
                
                            <h3>Для мультикнопки (тип 12)</h3>
                            <div class='example'>
            4.1,4.2,5.1
                            </div>
                            <p><strong>Пример 1:</strong> <code>3.1,4.1</code> — сначала зальёт фигуру красным, затем сделает линию синей.</p>
                            <p><strong>Пример 2:</strong> <code>2.5,8.1</code> — подгонит страницу под чертёж, затем экспортирует в PDF.</p>
                            <div class='warning'>⚠️ Важно: Номера кнопок должны существовать. Если кнопка удалена — мультикнопка пропустит её с предупреждением.</div>
                
                            <h3>Оптимизация работы</h3>
                            <ul>
                                <li><strong>Назначайте хоткеи</strong> для самых частых действий — работайте без мыши</li>
                                <li>Используйте <strong>минимальный режим</strong> во время активной работы в Visio</li>
                                <li>Для кнопок с иконками <strong>удаляйте текст</strong> — интерфейс станет чище</li>
                            </ul>
                
                            <h3>Безопасность</h3>
                            <ul>
                                <li>Приложение <strong>не изменяет</strong> ваши документы Visio напрямую — все действия выполняются через официальный COM-интерфейс</li>
                                <li>Настройки хранятся локально в папке:<br>
                                    <code>C:\Users\&lt;Ваш_пользователь&gt;\AppData\Roaming\PanelTimVisioPro\Profiles\</code></li>
                            </ul>
                
                            <h3>Требования</h3>
                            <ul>
                                <li>Windows 10/11 (64-bit)</li>
                                <li>Microsoft Visio 2010 и новее (для кнопок типов 1–9)</li>
                                <li>.NET Framework 4.8.1</li>
                            </ul>
                
                            <h3>❓ Частые вопросы</h3>
                
                            <p><strong>Вопрос:</strong> Кнопка не работает, хотя Visio запущен.</p>
                            <p><strong>Ответ:</strong> Убедитесь, что в Visio открыт документ и выделена фигура (для команд, требующих выделения).</p>
                
                            <p><strong>Вопрос:</strong> Как вернуть удалённую кнопку?</p>
                            <p><strong>Ответ:</strong> Удалённые кнопки не восстанавливаются. Создайте новую кнопку того же типа и настройте её заново.</p>
                
                            <p><strong>Вопрос:</strong> Хоткей не срабатывает.</p>
                            <p><strong>Ответ:</strong> Сочетание может быть занято другой программой. Попробуйте другую комбинацию (например, <code>Ctrl+Alt+цифра</code>).</p>
                
                            <p><strong>Вопрос:</strong> Можно ли использовать кнопки без запуска Visio?</p>
                            <p><strong>Ответ:</strong> Да — кнопки типов 10 (запуск .exe) и 12 (мультикнопка из типов 10) работают без Visio.</p>
                        </section>
                    </div>
        
                    <footer>
                        <p>PanelTimVisioPro © 2026 — Панель управления для Microsoft Visio</p>
                        <p>Все права защищены. Поддержка: <a href='https://vk.com/visioforelectrician' style='color: #667eea;'>Группа VK</a></p>
                    </footer>
                </div>
    
                <script>
                    // Плавная прокрутка к якорям
                    document.querySelectorAll('nav a').forEach(anchor => {
                        anchor.addEventListener('click', function(e) {
                            e.preventDefault();
                            const targetId = this.getAttribute('href');
                            const targetElement = document.querySelector(targetId);
                            if (targetElement) {
                                targetElement.scrollIntoView({
                                    behavior: 'smooth',
                                    block: 'start'
                                });
                            }
                        });
                    });
                </script>
            </body>
            </html>